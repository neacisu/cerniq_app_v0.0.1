# =============================================================================
# CERNIQ.APP â€” Docker Compose Override (Development Only)
# =============================================================================
# This file is automatically loaded by docker compose alongside docker-compose.yml
# DO NOT USE IN PRODUCTION - contains development-only services
# 
# Usage:
#   docker compose --profile dev up -d redisinsight
#   OR
#   docker compose -f docker-compose.yml -f docker-compose.dev.yml up -d redisinsight
#
# Reference: F0.3.2.T003, etapa0-plan-implementare-complet-v2.md, etapa0-port-matrix.md
# =============================================================================

services:
  # ==========================================================================
  # RedisInsight - Redis GUI for Development
  # ==========================================================================
  # Access: http://localhost:8001
  # Configure connection in UI:
  #   - Host: redis (or 172.28.0.20 via cerniq_backend)
  #   - Port: 64039 (per ADR-0022 port allocation)
  #   - Password: (from /var/www/CerniqAPP/secrets/redis_password.txt)
  # ==========================================================================
  redisinsight:
    image: redis/redisinsight:latest
    container_name: cerniq-redisinsight
    restart: unless-stopped
    ports:
      - "127.0.0.1:8001:5540"  # Bind only to localhost for security
    volumes:
      - redisinsight_data:/data
    networks:
      - cerniq_backend
    depends_on:
      redis:
        condition: service_healthy
    profiles:
      - dev
    labels:
      com.cerniq.app: "cerniq"
      com.cerniq.environment: "development"
      com.cerniq.service: "redisinsight"
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

volumes:
  redisinsight_data:
    driver: local
